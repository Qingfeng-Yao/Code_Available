随机与设计的碰撞，聊聊《死亡细胞》中的关卡生成
近年来，roguelike作为一种可玩性极高的游戏种类渐渐占据到大家的视野当中来，诸如《以撒的结合》，《挺进地牢》，《节奏地牢》等等，甚至还出现了一批地牢学家，不可否认roguelike类型已经成为了现代游戏的一个重要分支。 《死亡细胞》作为此品类下一款非常出色的游戏，取得了巨大的成功。在游戏中，玩家扮演一个可以无限复活的细胞人，在一次次轮回的过程中不断变强，了解真相的碎片，无数玩家在其中感受到了roguelike游戏的魅力：独一无二的体验，丰富有趣的武器库，不同分支的战斗方式等等。《死亡细胞早期原型》 其优秀的关卡生成也是功不可没，其在保证每局游戏地图不同的同时，又能给玩家带来一丝似曾相识的感觉，那么如此优秀的关卡生成是怎么做出来的呢？笔者参考《洞穴探险》随机生成的关卡在08年的国际Roguelike发展会上提到，roguelike类应包含的特点有生成随机性，进程单向性，不可挽回性，游戏非线性，系统复杂性。因此，为了保障roguelike特色，我们可以推测出一款优秀的关卡生成，要尽量满足三个特点：1. 系统复杂度高：样本基数大，降低重复性2. 进程公平性：尽量玩家需要探索的房间期望差距小，使得单向进程公平3. 关卡趣味性：就是大家理解的好玩，使随机是有意义的随机那么《死亡细胞》的制作人是怎么看待关卡生成的呢？在《How Dead Cells Cheated to Make the Game More Fun》采访中，制作人老哥提到了他们设计中的几个历程，总结大意如下：1.关卡生成难点在于如何让暴力生成的地图如何算的上好玩2.做算法只用了一周，但用此无法稳定生成有趣的关卡3.一个爆肝同事2周手制了1千个房间，每个都很棒，以此收到了启发4.后来决定的关卡生成：以手工制作的房间为基本单位（保证一个入口，一个出口）使用算法将房间暴力连接，合适就相连，不合适就替换简而言之就是：将手工房间随机拼接起来 如此我们就知道他们关卡设计的大体思路了，以手工设计的房间为基本单位，保证每个房间的趣味性，再调用一定的算法来使房间和房间相连接，得到最终结果。 那么让我们来尝试再现下他们的关卡生成吧。我们以第一关“被囚者牢房”为研究对象，为了方便操作，我们对地图模型进行抽象化。抽象标准：以传送门为基本连结单位，将门与门之间的房间抽象为线，传送门为数字，距离出生越远的门数字越大，忽略地图中的特殊房间。图标例如：ps：笔者玩的是ns版本，此图找pc的朋友截的抽象化后得到：上图的抽象版本，便于研究 确立模型之后，我又做了许多实验：其中的一些模型：观察整理可得：（鉴于样本数量问题，笔者只能做有限的推理）1. 大多数情况下，e1会在节点6或7的时候出现2. 大多数情况下，e2和e3的分岔路会在2或3节点出现3. 大多数请工况下，分叉点——节点——E2/E3是固定搭配4. 在一些情况下,以上节点数会有上下一定的浮动，影响原因可能为：奖励关和路径点重合 让我们复现一种简化的情况前提：※支路节点在节点3出现※e1在节点6出现※房间模型有20种 代码实现很简单，利用for循环控制输出，在节点之间输出房间号code结果：结果如此一来，一个简化版的生成方法就实现了，当然了，实际的系统还要复杂很多倍，在此基础上，让关卡设计师们爆肝，还要添加亿点细节。当随机遇上设计，当技术碰撞艺术，一个优秀的游戏就诞生了，这里是阿撸，一个热爱游戏的人，下期见。 制作人采访：https://www.youtube.com/watch?v=Uv5NwboDDhk&feature=youtu.be——————本文为小黑盒 进击的阿撸原创内容未经许可禁止转载
